<header>
  <mat-toolbar>
    <!-- Mobile menu button -->
    <button
      class="mobile-menu"
      mat-icon-button
      [matMenuTriggerFor]="mobileMenu"
      aria-label="Open navigation menu"
    >
      <mat-icon
        matBadge="1"
        matBadgeSize="small"
        matBadgeOverlap="false"
        [matBadgeHidden]="!(anyBadge$ | async)"
        >menu</mat-icon
      >
    </button>

    <!-- Mobile navigation menu -->
    <mat-menu #mobileMenu="matMenu">
      @for (tab of TABS; track tab.route) {
        <ng-container
          *ngTemplateOutlet="tabMenuItem; context: { $implicit: tab }"
        ></ng-container>
      }
      <button mat-menu-item [matMenuTriggerFor]="toolsMenu">
        <span>Other Tools</span>
      </button>
    </mat-menu>

    <!-- Shared tools submenu -->
    <mat-menu #toolsMenu="matMenu">
      @for (tool of TOOLS; track tool.route) {
        <button mat-menu-item [routerLink]="tool.route">
          <mat-icon>{{ tool.icon }}</mat-icon>
          <span>{{ tool.title }}</span>
        </button>
      }
    </mat-menu>

    <!-- Home button with logo -->
    <button
      class="home-btn"
      routerLink="/"
      matBadge="1"
      matBadgeSize="small"
      matBadgeOverlap="false"
      [matBadgeHidden]="!(newsBadge | async)"
      aria-label="Go to home page"
    >
      <pdz-icon name="logo" [height]="36"></pdz-icon>
    </button>

    <!-- Desktop navigation tabs -->
    <nav class="desktop-tabs" aria-label="Main navigation">
      @for (tab of TABS; track tab.route) {
        <button
          class="menu-tab"
          [routerLink]="tab.route"
          [matBadge]="(tab.badge | async) ?? ''"
          [matBadgeHidden]="!tab.badge || !(tab.badge | async)"
        >
          {{ tab.title }}
        </button>
      }
      <button class="menu-tab" [matMenuTriggerFor]="toolsMenu">
        Other Tools
      </button>
    </nav>

    <span class="toolbar-spacer"></span>

    <!-- Shop link -->
    <a
      href="https://shop.pokemondraftzone.com"
      target="_blank"
      rel="noopener noreferrer"
      class="store-button"
      aria-label="Visit the shop (opens in new tab)"
    >
      <span class="store-button__text">Shop</span>
      <mat-icon
        matBadge="1"
        matBadgeSize="small"
        matBadgeOverlap="false"
        [matBadgeHidden]="true"
        >apparel</mat-icon
      >
    </a>

    <pdz-login-button></pdz-login-button>
  </mat-toolbar>
</header>

<!-- Reusable template for tab menu items -->
<ng-template #tabMenuItem let-tab>
  <button
    mat-menu-item
    [routerLink]="tab.route"
    [matBadge]="(tab.badge | async) ?? ''"
    [matBadgeHidden]="!tab.badge || !(tab.badge | async)"
  >
    <span>{{ tab.title }}</span>
  </button>
</ng-template>
