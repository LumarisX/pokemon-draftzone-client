<div class="rules-editor">
  <div class="rules-header">
    <h2>League Rule Sections</h2>
    <button class="btn-add" (click)="addSection()" [disabled]="isSaving()">
      + Add Section
    </button>
  </div>

  <div
    class="save-message"
    *ngIf="saveMessage()"
    [class.success]="saveMessage()?.type === 'success'"
    [class.error]="saveMessage()?.type === 'error'"
  >
    {{ saveMessage()?.text }}
  </div>

  <div class="sections-list">
    <div *ngIf="rules().length === 0" class="empty-state">
      <p>No rule sections yet. Click "Add Section" to create one.</p>
    </div>

    <div *ngFor="let section of rules(); let i = index" class="section-editor">
      <div class="section-header">
        <div class="section-controls">
          <button
            class="btn-move"
            (click)="moveUp(i)"
            [disabled]="i === 0"
            title="Move up"
          >
            ↑
          </button>
          <button
            class="btn-move"
            (click)="moveDown(i)"
            [disabled]="i === rules().length - 1"
            title="Move down"
          >
            ↓
          </button>
          <button
            class="btn-delete"
            (click)="deleteSection(i)"
            title="Delete section"
          >
            Delete
          </button>
        </div>
      </div>

      <div class="section-content">
        <label class="label">Section Title</label>
        <input
          type="text"
          class="input-title"
          [(ngModel)]="section.title"
          (change)="onRuleChange()"
          placeholder="Enter section title"
        />

        <label class="label">Section Body</label>
        <textarea
          class="textarea-body"
          [(ngModel)]="section.body"
          (change)="onRuleChange()"
          placeholder="Enter rule details here..."
        ></textarea>
      </div>
    </div>
  </div>

  <div class="actions-footer">
    <button
      class="btn-save"
      (click)="saveRules()"
      [disabled]="!hasUnsavedChanges() || isSaving()"
    >
      {{ isSaving() ? "Saving..." : "Save Rules" }}
    </button>
    <span class="unsaved-indicator" *ngIf="hasUnsavedChanges()">
      ⚠ You have unsaved changes
    </span>
  </div>
</div>
