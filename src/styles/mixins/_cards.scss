@use "./buttons" as *;
@use "sass:map";
@use "../../styles/global.scss" as *;

$card-defaults: ();

@mixin pdz-card($style: "menu", $overrides: ()) {
  $card-defaults: (
    background: pdz-color(#{$style}-container),
    color: pdz-color(on-#{$style}-container),
    border-color: pdz-color(#{$style}-border),
    header: pdz-color(#{$style}-container-high),
    menu: pdz-color(#{$style}-subtle),
    on-menu: pdz-color(on-#{$style}-container),
    menu-hover: pdz-color(#{$style}-container-hover),
    border-radius: var(--pdz-shape-corner-md),
    border-width: 1px,
    border-style: solid,
    header-padding: var(--pdz-space-sm) var(--pdz-space-md),
    body-padding: var(--pdz-space-sm) var(--pdz-space-md),
    footer-padding: var(--pdz-space-xs) var(--pdz-space-md),
    menu-item-font-size: 1rem,
    menu-item-padding: var(--pdz-space-md),
    sprites-columns: 6,
    sprites-min-size: 36px,
    sprites-gap: var(--pdz-space-sm),
  );

  $config: map.merge($card-defaults, $overrides);

  background-color: map.get($config, "background");
  color: map.get($config, "color");
  border-radius: map.get($config, "border-radius");
  border-width: map.get($config, "border-width");
  border-color: map.get($config, "border-color");
  border-style: map.get($config, "border-style");
  display: flex;
  flex-direction: column;
  overflow: hidden;
  height: 100%;
  .card-header {
    background-color: map.get($config, "header");
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: map.get($config, "header-padding");
    .more-btn {
      @include icon-button(());
    }
  }

  .card-menu {
    position: relative;

    .menu-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background-color: map.get($config, "menu");
      color: map.get($config, "on-menu");
      border-radius: var(--pdz-shape-corner-sm);
      box-shadow: var(--pdz-level-2);
      z-index: 10;
      width: map.get($config, "menu-width");
      padding: var(--pdz-space-sm) 0;
      display: flex;
      flex-direction: column;

      .menu-item {
        display: flex;
        align-items: center;
        gap: var(--pdz-space-md);
        padding: map.get($config, "menu-item-padding");
        background: none;
        border: none;
        width: 100%;
        cursor: pointer;
        font-size: map.get($config, "menu-item-font-size");
        text-wrap: nowrap;
        &:hover {
          background-color: map.get($config, "menu-hover");
        }
      }
    }
  }

  .card-body {
    padding: map.get($config, "body-padding");
    flex-grow: 1;

    .ruleset-format {
      font-size: var(--pdz-font-size-sm);
      color: pdz-color(on-primary-container);
      margin-bottom: var(--pdz-space-sm);
    }

    .sprites {
      display: grid;
      grid-template-columns: repeat(
        map.get($config, "sprites-columns"),
        minmax(map.get($config, "sprites-min-size"), 1fr)
      );
      gap: map.get($config, "sprites-gap");
    }
  }

  .card-footer {
    padding: map.get($config, "footer-padding");
    border-top: map.get($config, "border-width")
      map.get($config, "border-style") map.get($config, "border-color");
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: var(--pdz-space-2xs);

    .footer-link {
      @include flat-button(
        (
          padding: var(--pdz-space-xs) var(--pdz-space-md),
          border-radius: var(--pdz-shape-corner-sm),
          background-hover: map.get($config, "footer-link-hover"),
          border: none,
        )
      );
    }
  }
}
